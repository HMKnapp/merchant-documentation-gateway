[#3DS2_IntegrationGuide_REST]
== 3D Secure 2 for REST API

[#3DS2_IntegrationGuide_REST_overview]
=== Overview

To integrate the WPP v2 in Seamles Mode in your shop, get your checkout page ready in two steps

To integrate 3D Secure 2 for REST API,

. Send a request with _check-enrollment._
. Redirect the customer to the Access Control Server (ACS) URL.
. Send a _check-payer-response_ request for validation of the authentication result (optional).
. Complete the payment transaction.

//-

.4. Complete the payment transaction 
Proceed with the payment ransaction with the relevant transaction-type (e.g. authorization, purchase, authorization-only).

NOTE: For payment-processing examples with 3DS2 see xy.

[#AppendixF]
=== 3D Secure Workflows

Depending on the information provided by the consumer, you can either perfom a frcitionless or a challenge 3D Secure 2 flow. Fallback to 3DS1.

image::images/16-05-appendix-f/3Dsecureprocessnew.png[3D Secure Workflow, align="center"]

[discrete]
[#AppendixF_3DS2FF]
==== 3D Secure 2.1 Frictionless Flow (Issuer supports 3D Secure 2)

image::images/16-05-appendix-f/3DSfrictionless.svg[3D Secure 2 Frictionless Workflow, align="center"]

*1.* *_Check-enrollment_*: This first step initiates the payment session and checks if the consumer’s card is enrolled in the 3D Secure 2 program. +
*1.1* Consumer (cardholder) checkout on your payment page. +

ifndef::env-nova[]
*1.2* Initiate the payment session with {payment-gateway} using the *check-enrollment* transaction type. Provide additional fields for 3D Secure 2 transactions. 3D Secure 2 fields can be found in the <<CreditCard_3DS2_Fields, 3D Secure 2 field table>> and are included in the <<Appendix_Xml, REST API payment XSD>>. +
endif::[]

ifdef::env-nova[]
*1.2* Initiate the payment session with {payment-gateway} using the *check-enrollment* transaction type. Provide additional fields for 3D Secure 2 transactions. 3D Secure 2 fields can be found in the <<CreditCard_3DS2_Fields, 3D Secure 2 field table>>. +
endif::[]

*1.3* {payment-gateway} checks the 3D Secure version supported by the issuer with the 3D Secure server. +
*1.4* {payment-gateway} returns the *check-enrollment* response. It includes the *PAReq*, the ACS URL, and the 3D Secure version. +

*2.* _Redirect the consumer to the ACS URL_ +
*2.1* Send an HTTPS POST request including the ACS URL, the *<PAReq>*, the *<TermUrl>* and *<MD>*. +
*2.2* The ACS URL points to the public endpoint of the {payment-provider-name} 3D Secure Router which decodes the *<PAReq>*. +
*2.3* The {payment-provider-name} 3D Secure Router returns an HTML with the scheme logo and a "processing" screen which is displayed in the consumer's browser. +
*2.4* The {payment-provider-name} 3D Secure Router redirects the consumer to the 3DSMethodURL for device fingerprinting. +
*2.5* The Issuer ACS gathers the information and redirects the 3D Secure method completion information to the
{payment-provider-name} 3D Secure Router URL. +
*2.6* The {payment-provider-name} 3D Secure Router initiates authentication with the issuer's ACS via the scheme directory server. +
*2.7* The {payment-provider-name} 3D Secure Router posts the SSL-encrypted and digitally signed *PARes* (Payment Authentication response) to the *TermURL* via the consumer’s browser. +

*3.* *_Check-payer-response_* _(optional) and_ *_PARes_* _verification_: Use this request to receive, analyze and store authentication values on your side or use your connection to the {payment-gateway}.  The *check-payer-response* provides the authentication values needed later for completion of the payment transaction. It is executed _after_ you receive the *check-enrollment* response and the *PARes*. +
*3.1* Send a POST request with transaction type *check-payer-response* to {payment-gateway}. Provide the ``parent-transaction-id`` using the ``transaction-id`` from the *check-enrollment* response, and the *PARes*. +
*3.2* {payment-gateway} decodes the *PARes*, checks the signature and retrieves the final authentication values. +
*3.3* {payment-gateway} returns the final authentication values in the response of the *check-payer-response* transaction. These include the ``dsTransId``, ``CAAV/AVV``, ``ECI``, and ``authenticationStatus``. +


*4.* _Complete the payment transaction_: Proceed with the payment transaction with the relevant transaction-type (e.g. *authorization*, *purchase*, *authorization-only*). Use the final authentication values received either from the check-enrollment response(e.g. *PARes* and ``parent-transaction-id``), or from step 3.3 (*check-payer-response* response).

[discrete]
[#AppendixF_3DS2CF]
==== 3D Secure 2.1 Challenge Flow (Issuer supports 3D Secure 2)

image::images/16-05-appendix-f/3DSchallenge.svg[3D Secure 2 Challenge Workflow, align="center"]

*1.* *_Check-enrollment_*: This first step initiates the payment session and checks if the consumer’s card is enrolled in the 3D Secure 2 program. +
*1.1* Consumer (cardholder) checkout on your payment page. +

ifndef::env-nova[]
*1.2* Initiate the payment session with {payment-gateway} using the *check-enrollment* transaction type. Provide additional fields for 3D Secure 2 transactions. 3D Secure 2 fields can be found in the <<CreditCard_3DS2_Fields, 3D Secure 2 field table>> and are included in the <<Appendix_Xml, REST API payment XSD>>. +
endif::[]

ifdef::env-nova[]
*1.2* Initiate the payment session with {payment-gateway} using the *check-enrollment* transaction type. Provide additional fields for 3D Secure 2 transactions. 3D Secure 2 fields can be found in the <<CreditCard_3DS2_Fields, 3D Secure 2 field table>>. +
endif::[]

*1.3* {payment-gateway} checks the 3D Secure version supported by the issuer with the 3D Secure server. +
*1.4* {payment-gateway} returns the *check-enrollment* response. It includes the *PAReq*, the ACS URL, and the 3D Secure version. +

*2.* _Redirect the consumer to the ACS URL_ +
*2.1* Send an HTTPS POST request including the ACS URL, the *<PAReq>*, the *<TermUrl>* and *<MD>*. +
*2.2* The ACS URL points to the public endpoint of the {payment-provider-name} 3D Secure Router which decodes the *<PAReq>*. +
*2.3* The {payment-provider-name} 3D Secure Router returns an HTML with the scheme logo and a "processing" screen which is displayed in the consumer's browser. +
*2.4* The {payment-provider-name} 3D Secure Router redirects the consumer to the 3DSMethodURL for device fingerprinting. +
*2.5* The Issuer ACS gathers the information and redirects the 3D Secure method completion information to the
{payment-provider-name} 3D Secure Router URL. +
*2.6* The {payment-provider-name} 3D Secure Router initiates authentication with the issuer's ACS via the scheme directory server. +
*2.7* The {payment-provider-name} 3D Secure Router redirects the consumer to the ACS which displays a challenge window (either a page or an iframe). +
*2.8* The consumer enters their data. After successful authentication, the ACS sends the challenge response to the {payment-provider-name} 3D Secure Router. +
*2.9* The {payment-provider-name} 3D Secure Router posts the SSL-encrypted and digitally signed *PARes* (Payment Authentication response) to the *TermURL* via the consumer’s browser. +

*3.* *_Check-payer-response_* _(optional) and_ *_PARes_* _verification_: Use this request to receive, analyze and store authentication values on your side or use your connection to the {payment-gateway}.  The *check-payer-response* provides the authentication values needed later for completion of the payment transaction. It is executed _after_ you receive the *check-enrollment* response and the *PARes*. +
*3.1* Send a POST request with transaction type *check-payer-response* to {payment-gateway}. Provide the ``parent-transaction-id`` using the ``transaction-id`` from the *check-enrollment* response, and the *PARes*. +
*3.2* {payment-gateway} decodes the *PARes*, checks the signature and retrieves the final authentication values. +
*3.3* {payment-gateway} returns the final authentication values in the response of the *check-payer-response* transaction. These include the ``dsTransId``, ``CAAV/AVV``, ``ECI``, and ``authenticationStatus``. +

*4.* _Complete the payment transaction_: Proceed with the payment transaction with the relevant transaction-type (e.g. *authorization*, *purchase*, *authorization-only*). Use the final authentication values received either from the check-enrollment response (e.g. *PARes* and ``parent-transaction-id``), or from step 3.3 (*check-payer-response* response).

[discrete]
[#AppendixF_3DS2FBF]
==== 3D Secure 2.1 Flow with Fallback to 3D Secure 1 (Issuer does not support 3D Secure 2)

image::images/16-05-appendix-f/3DSfallback.svg[3D Secure 2 Fallback Workflow, align="center"]

*1.* *_Check-enrollment_*: This first step initiates the payment session and checks if the consumer’s card is enrolled in the 3D Secure 2 program. +
*1.1* Consumer (cardholder) checkout on your payment page. +

ifndef::env-nova[]
*1.2* Initiate the payment session with {payment-gateway} using the *check-enrollment* transaction type. Provide additional fields for 3D Secure 2 transactions. 3D Secure 2 fields can be found in the <<CreditCard_3DS2_Fields, 3D Secure 2 field table>> and are included in the <<Appendix_Xml, REST API payment XSD>>. +
endif::[]

ifdef::env-nova[]
*1.2* Initiate the payment session with {payment-gateway} using the *check-enrollment* transaction type. Provide additional fields for 3D Secure 2 transactions. 3D Secure 2 fields can be found in the <<CreditCard_3DS2_Fields, 3D Secure 2 field table>>. +
endif::[]

*1.3* {payment-gateway} checks the 3D Secure version supported by the issuer with the 3D Secure server. If 3D Secure 2 is not supported then the 3D Secure server initiates the fallback to version 1 via the 3D Secure MPI. +
*1.4* {payment-gateway} returns the *check-enrollment* response. It includes the *PAReq*, the ACS URL, and the 3D Secure version. +

*2.* _Redirect the consumer to the ACS URL_ +
*2.1* Send an HTTPS POST request including the ACS URL, the *<PAReq>*, the *<TermUrl>* and *<MD>*. +
*2.2* The ACS URL points to the public endpoint of the issuer ACS, which decodes the *<PAReq>*. The ACS displays the authentication window for the cardholder. +
*2.3* The consumer enters their data in the authentication window displayed by the ACS. +
*2.4* The issuer ACS verifies the authentication credentials and posts the SSL-encrypted and digitally signed *PARes* (Payment Authentication response), as well as the *<MD>* to the *TermURL* via the consumer’s browser. +

*3.* *_Check-payer-response_* _(optional) and_ *_PARes_* _verification_: Use this request to receive, analyze and store authentication values on your side or use your connection to the {payment-gateway}.  The *check-payer-response* provides the authentication values needed later for completion of the payment transaction. It is executed _after_ you receive the *check-enrollment* response and the *PARes*. +
*3.1* Send a POST request with transaction type *check-payer-response* to {payment-gateway}. Provide the ``parent-transaction-id`` using the ``transaction-id`` from the *check-enrollment* response, and the *PARes*. +
*3.2* {payment-gateway} verifies the *PARes* with the 3D Secure MPI and receives the final authentication values. +
*3.3* {payment-gateway} returns the final authentication values in the response of the *check-payer-response* transaction. These include the ``XID``, ``CAAV/AVV``, ``ECI``, and ``authenticationStatus``. +

*4.* _Complete the payment transaction_: Proceed with the payment transaction with the relevant transaction-type (e.g. *authorization*, *purchase*, *authorization-only*). Use the final authentication values received either from the check-enrollment response (e.g. *PARes* and ``parent-transaction-id``), or from step 3.3 (*check-payer-response* response).

//-

NOTE: An Merchant Plug-In (MPI) provides a communication interface between the merchant and the card schemes' directory servers. It can be integrated in the merchant website or it may be hosted by a service provider or an acquirer. The main functions of an MPI are to verify the card issuers digital signature used in the authentication process, validate enrollment and authentication response messages, encrypt and store passwords and certificates and retrieve payment records and associated card details to resolve transaction disputes. Merchants can choose to leverage the enrollment check and payment authentication using a hosted (3rd Party MPI) or an integrated MPI.

[#3DS2_IntegrationGuide_REST_Samples]
=== Payment-Processing Examples with 3DS2

We provide ready-made JSON examples to show how to process a payment with 3DS2.
Use a tool such as  https://www.postman.com/postman[Postman] to test them.

The 3DS2 payment-processing examples are *designed for the testing environment* and *do not use real information.*

[#3DS2_IntegrationGuide_REST_Samples_SetUp]
==== Setup and Test Credentials

Before you can send your first request, use the following information to set up your testing tool:

[cols="h,"]
|===
|URL (Endpoint) | ``\https://{rest-api-test-endpoint}``
|===

Refer to one of the following tables to complete your test credentials:

ifdef::env-wirecard[]
include::{root}/include/3-d-secure/3-d-secure_testcredentials_manual.adoc[]
include::{root}/include/3-d-secure/3-d-secure_testcredentials_automatic.adoc[]
include::{root}/include/3-d-secure/3-d-secure_testcredentials_nongamblingOCT.adoc[]
endif::[]

ifdef::env-po[]
include::{rood}/include/3-d-secure/3-d-secure_testcredentials_po.adoc[]
endif::[]

[#3DS2_IntegrationGuide_REST_Samples_Samples]
==== Samples

Below, you can download a postman collection, containing samples for all common use cases documented in our 3D Secure 2 Use Cases section.

Download the full link:resources/3-d-secure-2/3-d-secure-2-postman-collection[3DS2 Postman Collection].



//tag::xy[]
//end::xy[]
[#3DS2_IntegrationGuide_REST_TestCards]
==== Test Cards

In this section you can find _3D Secure_ test cards for a variety of card brands. These test cards allow you to trigger a certain behaviour when you send them to our endpoint. We provide test cards for both versions, _3D Secure 1_ and _3D Secure 2._

.Example
If you want to provoke the error status code ``500.1072`` ("_Card Not Enrolled_.")
in combination with a Visa card for a _3D Secure_ transaction, use
_Card Number_ ``4012000300006002``, _Expiration Date_ ``{cc-exp-month}/{cc-exp-year}`` and _CVC_ ``002``.

[#3DS2_IntegrationGuide_REST_TestCards_3DSecure1]
===== 3D Secure 1 Transactions

When you do a <<CreditCard_PaymentFeatures_3DSecure, _3D Secure_ transaction>>,
{payment-gateway-abbr} checks with the first request, whether the card is enrolled in _3D Secure_.
A transaction is _3D Secure_, if the response returns a positive enrollment
check and a positive authentication result.

include::{root}/include/3-d-secure/3-d-secure_testcards_enrollment-authentication-values.adoc[]

[#3DS2_IntegrationGuide_REST_TestCards_3DSecure1_success]
.Card Numbers for Successful Transactions

With these card numbers you can provoke a successful response containing the
status code ``201.0000`` ("The resource was successfully created.").

include::{root}/include/3-d-secure/3-d-secure_testcards_success.adoc[]

[#API_CC_TestCards_3D_Error]
.Card Numbers for Error Results

With these card numbers you can provoke an error response containing a variety of status codes.

ifndef::env-nova[] 
ifdef::env-wirecard[]

[#API_CC_TestCards_3D_Error_AMEX]
include::{root}/include/3-d-secure/3-d-secure_testcards_error_amex.adoc[]

[#API_CC_TestCards_3D_Error_Diners]
include::{root}/include/3-d-secure/3-d-secure_testcards_error_diners.adoc[]

[#API_CC_TestCards_3D_Error_JCB]
include::{root}/include/3-d-secure/3-d-secure_testcards_error_jcb.adoc[]

endif::[]

[#API_CC_TestCards_3D_Error_Maestro]
include::{root}/include/3-d-secure/3-d-secure_testcards_error_maestro.adoc[]

endif::[]

[#API_CC_TestCards_3D_Error_Mastercard]
include::{root}/include/3-d-secure/3-d-secure_testcards_error_mastercard.adoc[]

ifndef::env-nova[]
ifdef::env-wirecard[]

[#API_CC_TestCards_3D_Error_UPI]
include::{root}/include/3-d-secure/3-d-secure_testcards_error_upi.adoc[]

endif::[]
endif::[]

[#API_CC_TestCards_3D_Error_Visa]
include::{root}/include/3-d-secure/3-d-secure_testcards_error_visa.adoc[]




[#CreditCard_3DS2_Fields]
==== New 3D Secure 2 Fields

We provide a full field reference table for 3D Secure 2.

NOTE: We recommend sending optional fields, such as `account-holder` phone numbers and `shipping.address`. If you submit this information, it is more likely that the Issuer authenticates the consumer without requesting <<CreditCard_PSD2_SCA, Strong Customer Authentication>>.

[cols="30m,6,9,7,48a"]
|===
|XML |Request |Datatype |Size |Description

|[[CreditCard_3DS2_Fields_Card_MerchantTokenizationFlag]]
card.merchant-tokenization-flag
|M
|Boolean
|
|Indicator whether or not a card token is stored on merchant side.

|card.account-type
|O
|String
|2
a|The type of account, e.g. for a multi-account card product. +
Possible values: ``01``, ``02``, ``03`` +
``01`` = Not Applicable. +
``02`` = Credit. +
``03``= Debit. +
Include this field: 

- If you want consumers to select the account type they are using before completing their purchase.
- For certain markets, e.g. Brazil.

//-
Otherwise, the field is optional.

|account-holder.account-info.authentication-method
|O
|String
|2
|Type of consumer login in the merchant's shop. +
 Possible values: ``01``, ``02``, ``03``, ``04``, ``05``, ``06`` +
 ``01`` = Guest checkout (i.e. the consumer is not logged in). +
 ``02`` = Login to the consumer's account in merchant's shop with shop-own authentication credentials. +
 ``03`` = Login with Federated ID. +
 ``04`` = Login with card issuer credentials. +
 ``05`` = Login with third-party authentication. +
 ``06`` = Login with FIDO authenticator.

|account-holder.account-info.authentication-timestamp
|O
|DateTime
|20
|Date and time (UTC) of the consumer login in the merchant's shop. Accepted format: ``YYYY-MM-DDThh:mm:ssZ``.
 For guest checkout, the DateTime is now.

| [[CreditCard_Fields_AccountHolder_AccountInfo_ChallengeIndicator]]
account-holder.account-info.challenge-indicator
|O
|String
|2
|Indicates whether a challenge is requested for this transaction. +
 Possible values: ``01``, ``02``, ``03``, ``04`` +
 ``01`` = No preference. +
 ``02`` = No challenge requested. +
 ``03`` = Challenge requested: Merchant Preference. +
 ``04`` = Challenge requested: Mandate. Must be sent in a first transaction that stores a token
 (e.g. for one-click checkout, first recurring payment, installments, UCOF).

NOTE: If the element is not provided, the ACS will interpret this as ``01`` = No preference.

|account-holder.account-info.creation-date
|O
|Date
|10
|Registration date (UTC) of the consumer's account in the merchant's shop. Accepted format: ``YYYY-MM-DD``.
 For guest checkout, do not send this field.

|account-holder.account-info.update-date
|O
|Date
|10
|Date that the consumer last made changes to their account in the merchant's shop. For example,
 changes to billing and shipping address, new payment account, new email address. Accepted format: ``YYYY-MM-DD``.
 For guest checkout, do not send this field.

|account-holder.account-info.password-change-date
|O
|Date
|10
|Date that the consumer last changed/reset their password in the merchant's shop. Accepted format: ``YYYY-MM-DD``.
 For guest checkout, do not send this field.

|account-holder.account-info.shipping-address-first-use
|O
|Date
|10
|Date that the consumer first used this shipping address in the merchant's shop. Accepted format: ``YYYY-MM-DD``.
 For guest checkout, do not send this field.

|account-holder.account-info.transactions-last-day
|O
|Numeric
|9
|Number of transactions (successful, failed, and canceled) that the consumer has attempted in the past 24 hours.
 Does not include merchant-initiated transactions.

|account-holder.account-info.transactions-last-year
|O
|Numeric
|9
|Number of transactions (successful, failed, and canceled) that the consumer has attempted within the past year.
 Does not include merchant-initiated transactions.

|account-holder.account-info.card-transactions-last-day
|O
|Numeric
|9
|Number of cards the consumer has attempted to add to their account in the merchant's shop for card-on-file payments
 (one-click checkout) in the past 24 hours.

|account-holder.account-info.purchases-last-six-months
|O
|Numeric
|9
|Number of successful orders by the consumer in the merchant's shop within the past six months.

|account-holder.account-info.suspicious-activity
|O
|Boolean
|
|Indicates if the merchant knows of suspicious activities by the consumer (e.g. previous fraud).

|account-holder.account-info.card-creation-date
|O
|Date
|10
|Date that the consumer's card was added to their account in the merchant's shop for card-on-file payments
 (one-click checkout). Accepted format: ``YYYY-MM-DD``. +
 For all other types of checkout (e.g. guest checkout, regular checkout, the first transaction with one-click checkout),
 the date is now.

|account-holder.merchant-crm-id
|O
|String
|64
|Consumer identifier in the merchant's shop.
 Requests that contain payment information from the same consumer in the same shop must contain the same string.

|account-holder.address.city
|M
|String
|50
|City of the consumer's billing address.


|account-holder.address.country
|M
|String
|2
|Country of the consumer's billing address. Format: ISO 3166-1 alpha-2 country code.

|account-holder.address.street1
|M
|String
|50
|Line 1 of the street address of the consumer's billing address.

|account-holder.address.street2
|O
|String
|50
a|Line 2 of the street address of the consumer's billing address.

|account-holder.address.street3
|O
|String
|50
a|Line 3 of the street address of the consumer's billing address.

|account-holder.address.postal-code
|M
|String
|16
|ZIP/postal code of the consumer's billing address.

|account-holder.address.state
|O
|String
|3
a|State/province of the consumer's billing address. Accepted format: numeric ISO 3166-2 standard.

|account-holder.email
|M
|String
|256
|The consumer's email address as given in the merchant's shop.

|account-holder.phone
|O
|String
|18
a|Home phone number provided by the consumer.

|account-holder.mobile-phone
|O
|String
|18
a|Mobile phone number provided by the consumer.

|account-holder.work-phone
|O
|String
|18
|Work phone number provided by the consumer.

|account-holder.first-name
|M
|String
|32
|The last name provided by the consumer as part of the credit card details.

|account-holder.last-name
|M
|String
|32
|The last name provided by the consumer as part of the credit card details.

|shipping.address.city
|O
|String
|50
a|City of the consumer's shipping address. Please provide this field even if billing city is identical.

|shipping.address.country
|O
|String
|2
a|Country of the consumer's shipping address.
Please provide this field even if billing country is identical.
Format: ISO 3166-1 alpha-2 country code.

|shipping.address.street1
|O
|String
|50
a|Line 1 of the street address of the consumer's shipping address. Please provide this field even if billing address is identical.

|shipping.address.street2
|O
|String
|50
a|Line 2 of the street address of the consumer's shipping address. Please provide this field even if billing address is identical.

|shipping.address.street3
|O
|String
|50
a|Line 3 of the street address of the consumer's shipping address. Please provide this field even if billing address is identical.

|shipping.address.postal-code
|O
|String
|16
a|ZIP/postal code of the consumer's shipping address. Please provide this field even if billing address is identical.

|shipping.address.state
|O
|String
|3
a|State/province of the consumer's shipping address. Accepted format: numeric ISO 3166-2 standard.
Please provide this field even if billing address is identical.

|shipping.shipping-method
|O
|String
|restriction-based enumeration value
a|The shipping method chosen by the consumer.
 Merchants must use the shipping indicator value that applies most accurately to the shipping method. If the consumer checks out two or more items, use the shipping indicator value for physical goods. If all are digital goods, use the shipping indicator value that matches the most expensive item.+
 Accepted values are:

- ``home_delivery``: Ship to consumer's billing address. +
- ``verified_address_delivery``: Ship to another address known to and verified by the merchant. +
- ``other_address_delivery``: Ship to an address that differs from the consumer's billing address. +
- ``store_pick_up``: "Ship to Store" / Pick-up at local store (store address in shipping address fields). +
- ``digital_goods``: Digital goods (includes online services, electronic gift cards, and redemption codes). +
- ``digital_tickets``: Travel and event tickets, not shipped. +
- ``other_verified``: Other (e.g. gaming, digital services, e-media subscriptions)

|risk-info.delivery-timeframe
|O
|String
|2
|The approximate delivery time. +
 Accepted values are: ``01``, ``02``, ``03``, ``04`` +
 ``01`` = Electronic delivery +
 ``02`` = Same-day delivery +
 ``03`` = Overnight delivery +
 ``04`` = Two-day or more delivery

|risk-info.delivery-mail
|O
|String
|254
|The consumer's email address used for electronic delivery of digital goods.

|risk-info.reorder-items
|O
|String
|2
|The consumer has previously ordered the same item.
 Accepted values are: ``01``, ``02`` +
 ``01`` = First-time order +
 ``02`` = Reorder

|risk-info.availability
|O
|String
|2
|The consumer is placing an order for merchandise that is not yet available and will be released in the future.
 Accepted values are: ``01``, ``02`` +
 ``01`` = Currently available +
 ``02`` = Future availability

|risk-info.preorder-date
|O
|Date
|10
|Expected shipping date for pre-ordered goods. Accepted format: ``YYYY-MM-DD``.

|risk-info.gift-cards.gift-card@id
|O
|Numeric
|2
|For prepaid and gift card purchase only. Identifies individual gift cards. Information about up to 10 gift cards can be sent in one request.
Accepted values range from ``1`` to ``10``.

|risk-info.gift-cards.gift-card.amount
|O
|Decimal
|18,2
|For prepaid and gift card purchase only. The amount paid with a specific gift card. The field allows decimal values (e.g. 10.50).

|risk-info.gift-cards.gift-card.amount@currency
|O
|String
|3
|For prepaid and gift card purchase only. The ISO 4217 three-digit currency code of the gift card. 

ifndef::env-nova[]
|[[CreditCard_3DS2_Fields_PeriodicRecurringExpireDate]]
periodic.recurring-expire-date
|O
|Date
|10
|For recurring payments. **Required only for authentication of the first transaction.** Date after which further recurring payments with this card are no longer allowed. Accepted format: ``YYYY-MM-DD``.

|[[CreditCard_3DS2_Fields_PeriodicRecurringFrequency]]
periodic.recurring-frequency
|O
|Numeric
|4
|For recurring payments. **Required only for authentication of the first transaction.** Indicates the minimum number of days between individual authorizations.

|[[CreditCard_3DS2_Fields_Periodic_NumberOfInstallments]]
periodic.number-of-installments
|O
|Numeric
|3
|For installment payments. **Required only for authentication of the first transaction.** Indicates the maximum number of authorizations permitted for installment payments.
endif::[]

|iso-transaction-type
|O
|String
|2
|Identifies the transaction type. The values are derived from ISO 8583.
 Accepted values are: ``01``, ``03``, ``10``, ``11``, ``28`` +
 ``01`` = Goods/Service Purchase +
 ``03`` = Check Acceptance +
 ``10`` = Account Funding +
 ``11`` = Quasi-Cash Transaction +
 ``28`` = Prepaid Activation and Load

|browser.accept
|O
|String
|2048
|This is the HTTP Accept Header as retrieved from the consumer’s browser in the HTTP request. If the string is longer than 2048, it must be truncated. It is strongly recommended to provide this field to prevent rejection from the ACS server.

|browser.user-agent
|O
|String
|256
|This is the User Agent as retrieved from the consumer’s browser in the HTTP request. If it is longer than 256 bytes it must be truncated. It is strongly recommended to provide this field to prevent rejection from the ACS server.

|browser.java-enabled
|O
|Boolean
|
|Boolean that represents the ability of the cardholder browser to execute Java. +
 Value is returned from the ``navigator.javaEnabled`` property.

|browser.language
|O
|String
|8
|Value representing the browser language as defined in IETF BCP47. The value is limited to 1-8 characters. +
 Value is returned from ``navigator.language`` property.

|browser.color-depth
|O
|Numeric
|2
|Value representing the bit depth of the color palette for displaying images, in bits per pixel. Obtained
 from consumer browser using the ``screen.colorDepth`` property. + 
 Accepted values are: ``1``, ``4``, ``8``, ``15``, ``16``, ``24``, ``32``, ``48``

|browser.screen-resolution
|O
|String
|12
|Total height and width of the consumer's screen in pixels. Value is returned from the ``screen.height`` and ``screen.width`` properties.

|browser.challenge-window-size
|O
|String
|2
|Dimensions of the challenge window as displayed to the
consumer. The ACS replies with content that is formatted to
correctly render in this window to provide the best possible user
experience. +
Preconfigured sizes are width X height in pixels of the window
displayed in the consumer's browser window. This is used only to prepare
the _CReq_ request and it is not part of the _AReq_ flow. If not present, it
will be omitted. +
Accepted values are: ``01``, ``02``, ``03``, ``04``, ``05`` +
``01`` = 250 x 400 +
``02`` = 390 x 400 +
``03`` = 500 x 600 +
``04`` = 600 x 400 +
``05`` = Full screen

| [[CreditCard_3DS2_Fields_ThreeD_Version]]
 three-d.version
|O
|String
|5
|Identifies the version of 3D Secure authentication used for the transaction.
Accepted values are: ``1.0``, or ``2.1``. If the version is not entered in the request, the field defaults to ``1.0``.

|three-d.ds-transaction-id
|O
|String
|36
|Unique transaction identifier assigned by the Directory Server to identify a single transaction.
Required for external 3D Secure servers not provided by {payment-provider-name}. Format: see IETF RFC 4122.

|three-d.riid
|O
|String
|2
|For 3D Secure 2.2. Indicates the type of 3RI request. +
Accepted values are: ``01``, ``02``, ``03``, ``04``, ``05`` +
``01`` = Recurring transaction +
``02`` = Installment transaction +
``03`` = Add card +
``04`` = Maintain card information +
``05`` = Account
|===

//-
