[[page]]
[[main]]
[[main-header]]
[[breadcrumb-section]]
1.  link:index.html[API merchant specification]
2.  link:API-merchant-specification_1146901.html[API merchant
specification]
3.  link:Payment-Page-Solutions_4751423.html[Payment Page Solutions]
4.  link:Wirecard-Payment-Page_3704201.html[Wirecard Payment Page]
5.  link:Payment-Methods-with-WPP_3704241.html[Payment Methods with WPP]

[[title-heading]]
[[title-text]] API merchant specification : paysafecard with WPP
-----------------------------------------------------------------

[[content]]
Created by Dorothea Bartel, last modified on Jan 14, 2019

[[main-content]]
* link:#paysafecardwithWPP-TestCredentials[Test Credentials]
* link:#paysafecardwithWPP-CountriesandCurrencies[Countries and
Currencies]
* link:#paysafecardwithWPP-TransactionTypes[Transaction Types]
** link:#paysafecardwithWPP-DebitDebit[Debit]
** link:#paysafecardwithWPP-AuthorizationAuthorization[Authorization]
** link:#paysafecardwithWPP-Capture-AuthorizationCapture-authorization[Capture-authorization]
* link:#paysafecardwithWPP-Void-authorization[Void-authorization]
* link:#paysafecardwithWPP-NVPFieldReference[NVP Field Reference]
** link:#paysafecardwithWPP-Response-onlyFields[Response-only Fields]

This is a reference page for *paysafecard*. Here you find all the
necessary information for integrating this payment method in
your https://document-center.wirecard.com/display/PTD/HPP+Integration[Hosted] or https://document-center.wirecard.com/display/PTD/EPP+Integration[Embedded] Payment
Page.

Are you familiar with Wirecard Payment Page (WPP)?

Visit one of the integration guides
(*https://document-center.wirecard.com/display/PTD/HPP+Integration[Hosted]* or **https://document-center.wirecard.com/display/PTD/EPP+Integration[Embedded] **Payment
Page) for a quick explanation & a step-by-step guide before
continuing. +
All
https://document-center.wirecard.com/display/PTD/Wirecard+Payment+Page[*WPP*]
integrations share a
*https://document-center.wirecard.com/display/PTD/WPP+Workflow[common
process flow]* for creating payments.

Below, you find example requests for each transaction type
(link:#paysafecardwithWPP-Debit[debit], link:#paysafecardwithWPP-Authorization[authorization] and link:#paysafecardwithWPP-Capture-Authorization[capture-authorization]),
including field lists with short descriptions. +
These requests are *designed for the testing environment* and *do not
use real information*. For your production environment, you need to use
your production credentials. If you need your production
credentials, contact mailto:support@wirecard.com[merchant support].

All examples presented here should return successful responses.

For more details on the `redirect-url`s, see
the https://document-center.wirecard.com/display/PTD/Configuring+Redirects+and+IPNs+for+WPP[Configuring
Redirects and IPNs for WPP] section. +
For response verification examples, see
the https://document-center.wirecard.com/display/PTD/WPP+Security[WPP
Security] section.

*About paysafecard*

 

image:attachments/4390994/4391012.png[image,width=340]paysafecard is a
well-known prepaid electronic payment method for mainly online shopping
e.g. in gaming, social media & communities and music, film &
entertainment industries. paysafecard is currently available in many
countries and languages all over the world. It offers a broad selection
of currencies to choose from.

Consumers either purchase a paysafecard voucher which contains a
16-digit PIN from sales outlets or from authorized online PIN shops, or
alternatively, create a _my paysafecard account_ defining their personal
username and password.

paysafecard PINs can be used multiple times for paying in online shops
or for topping up the _my paysafecard account_.

Using _my paysafecard_ during the payment process in an online shop, you
do not have to reenter the PIN again, only username and password are
required.

Paying with paysafecard, the consumer enters the 16 digit number and the
amount tendered is deducted from the paysafecard balance. Thus, the same
PIN code can be used multiple times. For larger sums, it is possible to
combine various paysafecard PINs. Combining PINs also allows consumers
to use up any remaining credit on a paysafecard PIN. The current balance
of each paysafecard as well as its transaction history and production
date can be viewed at the official paysafecard site by entering the
respective 16 digit PIN code.

Payments for goods or services other than EUR are converted into EUR at
the conversion rate at the time of purchase. The conversion fee varies
depending on the original currency and end currency and it varies from
country to country. The currency conversion rates for foreign currencies
are always available on the paysafecard web site.

'''''

[[paysafecardwithWPP-TestCredentials]]
Test Credentials
----------------

Merchant Test Credentials

*URI (Endpoint)*

`https://wpp-test.wirecard.com/api/payment/register`

*Username*

`70000-APITEST-AP`

*Password*

`qD2wzQ_hrc!8`

*MAID (`merchant-account-id`)*

`4c0de18e-4c20-40a7-a5d8-5178f0fe95bd`

*Secret Key (used for response verification)*

`bb1f2975-827b-4aa8-bec6-405191d85fa5`

Test credentials for paysafecard sandbox

*16-digit PIN:* `3105 6626 4830 5874`

 

'''''

[[paysafecardwithWPP-CountriesandCurrencies]]
Countries and Currencies
------------------------

paysafecard can be used in the following countries and with the listed
currencies:

[width="100%",cols="50%,50%",]
|=======================================================================
|*Countries* a|
*Europe:* +
Austria, Belgium, Bulgaria, Croatia, Cyprus, Czech Republic, Denmark,
Finland, France, Georgia, Germany, Greece, Hungary, Ireland, Italy,
Latvia, Lithuania, Luxembourg, Malta, Montenegro, The Netherlands,
Norway, Poland, Portugal, Romania, Slovakia, Slovenia, Spain, Sweden,
Switzerland, Turkey, UK

*North & South America:* +
Argentina, Brazil, Canada, Mexico, Peru, Uruguay, USA

*Middle East:* +
Kuwait, Saudi Arabia, UAE

*Oceania:* +
Australia, New Zealand

*Africa:* +
Egypt

|*Currencies* |AED, ARS, AUD, BRL, CAD, CHF, CZK, DKK, EGP, EUR, GBP,
GEL, HRK, HUF, KWD, MXN, NOK, NZD, PEN, PLN, RON, SAR, SEK, TRY, USD,
UYU
|=======================================================================

 

'''''

[[paysafecardwithWPP-TransactionTypes]]
Transaction Types
-----------------

Available transaction types for paysafecard:

* link:#paysafecardwithWPP-Debit[Debit]
* link:#paysafecardwithWPP-Authorization[Authorization]
* link:#paysafecardwithWPP-Capture-Authorization[Capture-authorization]

[[paysafecardwithWPP-DebitDebit]]
[[paysafecardwithWPP-Debit]]Debit
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A debit transaction charges the consumer's paysafecard account with the
specified amount and transfers it immediately.

A debit is

* created during payment processing and
* finalized with the response (confirmation of the initial debit
request).

*Debit workflow in detail:*

1.  The consumer initiates the debit transaction (e.g. by clicking the
"Pay Now" button). The merchant sends an initial debit request to
Wirecard.
2.  As a response, the merchant receives the `payment-redirect-url` with
a `PaymentToken`. This URL redirects to the paysafecard payment page
(hosted by paysafecard).
3.  The merchant must use this `payment-redirect-url `to redirect the
consumer. On the paysafecard payment page, the consumer enters the
paysafecard PIN and submits the payment.
4.  The consumer is redirected to the WPP processing page.
5.  After the transaction has been approved, the consumer is redirected
back to the merchant's shop (redirection URLs,
see link:#paysafecardwithWPP-DebitSampleRequest[sample request]). There,
the consumer and the merchant are notified about the outcome of the
payment process. +
We **recommend** that the merchant includes
a **notification-URL** (see link:#paysafecardwithWPP-DebitSampleRequest[sample
request]) to receive a payment notification directly from Wirecard
Payment Gateway.

 +

Step by step guide to a successful debit transaction

1.  Create a payment session (initial debit request).
2.  Redirect the consumer to the payment page (initial response URL).
3.  Highly recommended: Parse and process the payment response.

We provide ready-made JSON examples for each step of this process. You
can find them below.

API Endpoints

*Test*

`https://wpp-test.wirecard.com/api/payment/register`

*Production/Live*

Contact mailto:support@wirecard.com[merchant support] for your
production credentials.

{empty}[[paysafecardwithWPP-DebitSampleRequest]]

*Request headers*

[source,syntaxhighlighter-pre]
----
Content-Type: application/json
Authorization: Basic NzAwMDAtQVBJVEVTVC1BUDpxRDJ3elFfaHJjITg=
----

 

*1. Create a payment session (initial request)*

[source,syntaxhighlighter-pre]
----
{
    "payment":{ 
        "merchant-account-id":{ 
            "value":"4c0de18e-4c20-40a7-a5d8-5178f0fe95bd"
        },
        "request-id":"{{$guid}}",
        "transaction-type":"debit",
        "requested-amount":{ 
            "value":10.1,
            "currency":"EUR"
        },
        "account-holder":{
            "merchant-crm-id":"A123456789"
        },
        "payment-methods":{ 
            "payment-method":[ 
               { 
               "name":"paysafecard"
                }
            ]
        },
        "notifications": {
            "notification": [
                {
                "url": "https://yourdomain.com/ipn.php"
                }
            ]
        },
        "success-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/success",
        "cancel-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/cancel",
        "fail-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/error"
    }
}
----

*Field (JSON)*

*Data Type*

*Required/* +
*Optional*

*Size*

*Description*

merchant-account-id

value

String

required

36

A unique identifier assigned to every merchant account (by Wirecard).
You receive a unique merchant account ID for each payment method.

request-id

String

required

64

A unique identifier assigned by the merchant to each request. Used when
searching for or referencing it later.

You may enter any `request-id` that has never been used before.

As the request-id must be unique, `{{$guid}}` serves as a placeholder;
e.g. Postman uses it to generate a random `request-id` for testing. 

Allowed characters: +
a - z +
A - Z +
0 - 9 +
-_

transaction-type

String

required

n/a

The requested transaction type, i.e. "`debit"`.

Available transaction types for paysafecard:

* `authorization`
* `capture-authorization`
* `debit`

requested-amount 

value

Numeric

required

9.2

The full amount that is requested/contested in a transaction. 2 decimals
digits allowed.

currency

String

required

3

The currency of the requested/contested transaction amount. +
Format: 3-character abbreviation according to ISO 4217.

account-holder

merchant-crm-id

String

required

64

Unique ID identifying the consumer of your online shop, e.g. from your
CRM system. +
The parameter must not be a human readable e-mail address. However, if
an e-mail address is used, you have to hash it beforehand.

payment-method

name

String

required

256

The name of the payment method used for the transaction, i.e.
"`paysafecard"`.

notification-url

String

optional

 

The URL to which Wirecard Payment Gateway sends the transaction outcome.

success-redirect-url

String

required

2000

The URL to which the consumer is redirected after a successful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/success`

cancel-redirect-url

String

required

2000

The URL to which the consumer is redirected after having cancelled a
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/cancel`

fail-redirect-url

String

required

2000

The URL to which the consumer is redirected after an unsuccessful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/error`

{empty}[[paysafecardwithWPP-step2]]

 

*2. Redirect the consumer to the payment page (initial response URL)*

[source,syntaxhighlighter-pre]
----
{
"payment-redirect-url": "https://wpp-test.wirecard.com/processing?wPaymentToken=V7VmWd2cB5hR9LB7X_KZRYDbY1brTNYpvZI-p98DnuE"
}
----

[cols=",,",]
|=======================================================================
|*Field (JSON)* |*Data Type* |*Description*

|payment-redirect-url |String |The URL which redirects to the payment
form (hosted by paysafecard). Sent as a response to the initial request.
|=======================================================================

The response to this link:#paysafecardwithWPP-DebitSampleRequest[initial
debit request] is the `payment-redirect-url`. +
At this point, you need to redirect your consumer
to `payment-redirect-url` (or render it in an `iframe` depending on
your https://document-center.wirecard.com/display/PTD/Wirecard+Payment+Page[integration
method]), where the consumer is to enter payment details.

The consumer is redirected to the payment form. There they enter their
data and submit the form to confirm the payment.

A payment can

* be successful (`transaction-state: success`)
* fail (`transaction-state: failed`)
* or the consumer cancelled the payment before/after submission
(`transaction-state: failed`).

The transaction result is the value of `transaction-state `in the
payment response. More details (including the
link:#paysafecardwithWPP-StatusCode[status code]) can also be found in
the payment response in the `statuses` object. Cancelled payments are
returned as `"transaction-state" : "failed"`, but the
link:#paysafecardwithWPP-StatusDescription[status description] indicates
it was cancelled.

In any case, a base64 encoded response containing payment information is
sent to one of the configured redirection URLs
(`success-redirect-url`, `cancel-redirect-url`, or `fail-redirect-url`).

See https://document-center.wirecard.com/display/PTD/Configuring+Redirects+and+IPNs+for+WPP[Configuring
Redirects and IPNs for WPP] for more details on redirection targets
after payment. You can find a decoded payment response example below.

*3. Parse and process the payment response (decoded payment response)*

[source,syntaxhighlighter-pre]
----
{
    "payment" : {
        "merchant-account-id" : {
            "value" : "4c0de18e-4c20-40a7-a5d8-5178f0fe95bd"
        },
        "request-id" : "66b62159-691f-40e3-8411-24c854bb0f8b",
        "account-holder" : {
            "merchant-crm-id" : "A123456789"
        },
        "transaction-type" : "debit",
        "parent-transaction-id" : "8d2ec658-d234-44cb-b557-791489e8464f",
        "payment-methods" : {
            "payment-method" : [ {
                "name" : "paysafecard"
            } ]
        },
        "transaction-state" : "success",
        "transaction-id" : "1f806091-5ab1-4832-8ccf-64232f1a7677",
        "completion-time-stamp" : "2018-09-26T05:54:20",
        "requested-amount" : {
            "currency" : "EUR",
            "value" : 10.100000
        },
        "statuses" : {
            "status" : [ {
                "description" : "The resource was successfully created.",
                "severity" : "information",
                "code" : "201.0000"
            } ]
        },
        "api-id" : "wpp",
        "success-redirect-url" : "https://demoshop-test.wirecard.com/demoshop/#!/success",
        "cancel-redirect-url" : "https://demoshop-test.wirecard.com/demoshop/#!/cancel",
        "fail-redirect-url" : "https://demoshop-test.wirecard.com/demoshop/#!/error"
    }
}
----

*Field (JSON)*

*Data Type*

*Description*

merchant-account-id

value

String

A unique identifier assigned to every merchant account (by Wirecard).
You receive a unique merchant account ID for each payment method.

request-id

String

A unique identifier assigned to every request (by merchant). Used when
searching for or referencing it later.

account-holder

merchant-crm-id

String

Unique ID identifying the consumer of your online shop, e.g. from your
CRM system.

transaction-type

String

The requested transaction type, i.e. "`debit"`.

parent-transaction-id

String

The ID of the transaction being referenced as a parent. As a `debit`
transaction is internally split into sub-transactions, the
`parent-transaction-id` serves to link these sub-transactions.

payment-method

name

String

The name of the payment method used for the transaction, i.e.
"`paysafecard"`.

transaction-state

String

The current transaction state.

Possible values:

* `in-progress`
* `success`
* `failed`

Typically, a transaction starts with state "`in-progress"` and finishes
with state either `"success"` or `"failed"`. This information is
returned in the response only.

transaction-id

String

A unique identifier assigned to every transaction. Used when searching
for or referencing it later.

completion-time-stamp

Date

The UTC/ISO time-stamp documenting the time & date when the transaction
was executed. +
Format: YYYY-MM-DDThh:mm:ss.sssZ (ISO).

requested-amount 

value

Numeric

The full amount that was requested/contested in the transaction.

currency

String

The currency of the requested/contested transaction amount. +
Format: 3-character abbreviation according to ISO 4217.

[[paysafecardwithWPP-Statuses]]status +
 +

[[paysafecardwithWPP-StatusDescription]]description

String

The description of the transaction status message. +
Click https://document-center.wirecard.com/display/PTD/Return+Codes+and+Transaction+Statuses[here] for
a complete list of status descriptions.

severity

String

The definition of the status message.

Possible values:

* `information`
* `warning`
* `error`

[[paysafecardwithWPP-StatusCode]]code

String

Status code of the status message. +
Click https://document-center.wirecard.com/display/PTD/Return+Codes+and+Transaction+Statuses[here] for
a complete list of status codes.

api-id

String

Identifier of the currently used API.

success-redirect-url

String

The URL to which the consumer is redirected after a successful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/success`

cancel-redirect-url

String

The URL to which the consumer is redirected after having cancelled a
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/cancel`

fail-redirect-url

String

The URL to which the consumer is redirected after an unsuccessful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/error`

'''''

[[paysafecardwithWPP-AuthorizationAuthorization]]
[[paysafecardwithWPP-Authorization]]Authorization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

An authorization

* reserves funds on a consumer's paysafecard account (e.g. until the
merchant ships/delivers the goods/services).
* does not trigger money transfer.  

To transfer money, the amount has to be captured with the transaction
type `capture-authorize`.

For a successful authorization transaction

1.  Create an authorization session (initial authorization request).
2.  Redirect the consumer to the payment page (initial response URL).
3.  Highly recommended: Parse and process the payment response.

API Endpoints

*Test*

`https://wpp-test.wirecard.com/api/payment/register`

*Production/Live*

Contact mailto:support@wirecard.com[merchant support] for your
production credentials.

{empty}[[paysafecardwithWPP-AuthorizationSampleRequest]]

*Request headers*

[source,syntaxhighlighter-pre]
----
Content-Type: application/json
Authorization: Basic NzAwMDAtQVBJVEVTVC1BUDpxRDJ3elFfaHJjITg=
----

 

*1. Create an authorization session (authorization request)*

[source,syntaxhighlighter-pre]
----
{
    "payment":{ 
        "merchant-account-id":{ 
            "value":"4c0de18e-4c20-40a7-a5d8-5178f0fe95bd"
        },
        "request-id":"{{$guid}}",
        "transaction-type":"authorization",
        "requested-amount":{ 
            "value":10.1,
            "currency":"EUR"
        },
        "account-holder":{
            "merchant-crm-id":"A123456789"
        },
        "payment-methods":{ 
            "payment-method":[ 
               { 
               "name":"paysafecard"
                }
            ]
        },
        "notifications": {
            "notification": [
                {
                "url": "https://yourdomain.com/ipn.php"
                }
            ]
        },
        "success-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/success",
        "cancel-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/cancel",
        "fail-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/error"
    }
}
----

*Field (JSON)*

*Data Type*

*Required/* +
*Optional*

*Size*

*Description*

merchant-account-id

value

String

required

36

A unique identifier assigned to every merchant account (by Wirecard).
You receive a unique merchant account ID for each payment method.

request-id

String

required

64

A unique identifier assigned by the merchant to each request. Used when
searching for or referencing it later.

You may enter any `request-id `that has never been used before.

As the` request-id` must be unique, `{{$guid}}` serves as a placeholder;
e.g. Postman uses it to generate a random `request-id` for testing. 

Allowed characters: +
a - z +
0 - 9 +
-

transaction-type

String

required

n/a

The requested transaction type, i.e. `"authorization"`.

Available transaction types for paysafecard:

* `authorization`
* `capture-authorization`
* `debit`

requested-amount 

value

Numeric

required

9.2

The full amount that is requested/contested in a transaction. 2 decimal
digits allowed.

currency

String

required

3

The currency of the requested/contested transaction amount. +
Format: 3-character abbreviation according to ISO 4217.

account-holder

merchant-crm-id

String

required

64

The unique identifier of your consumer of your online shop, e.g. from
your CRM system. +
The parameter must not be a human readable e-mail address. However, if
an e-mail address is used, you have to hash it beforehand.

payment-method

name

String

required

256

The name of the payment method used for the transaction, i.e.
`"paysafecard"`.

notification-url

String

optional

256

The URL to which Wirecard Payment Gateway sends the transaction outcome.

success-redirect-url

String

required

2000

The URL to which the consumer is redirected after a successful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/success`

cancel-redirect-url

String

required

2000

The URL to which the consumer is redirected after having cancelled a
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/cancel`

fail-redirect-url

String

required

2000

The URL to which the consumer is redirected after an unsuccessful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/error`

The response to this
link:#paysafecardwithWPP-AuthorizationSampleRequest[initial
authorization request] is the `payment-redirect-url`. +
Proceed with link:#paysafecardwithWPP-step2[step 2] in a similar way as
described for link:#paysafecardwithWPP-Debit[debit].

*3. Parse and process the authorization response (decoded payment
response)*

[source,syntaxhighlighter-pre]
----
{
    "payment" : {
        "merchant-account-id" : {
            "value" : "4c0de18e-4c20-40a7-a5d8-5178f0fe95bd"
        },
        "request-id" : "66b62159-691f-40e3-8411-24c854bb0f8b",
        "account-holder" : {
            "merchant-crm-id" : "A123456789"
        },
        "transaction-type" : "authorization",
        "parent-transaction-id" : "8d2ec658-d234-44cb-b557-791489e8464f",
        "payment-methods" : {
            "payment-method" : [ {
                "name" : "paysafecard"
            } ]
        },
        "transaction-state" : "success",
        "transaction-id" : "The-transaction-id-received-here-is-the-parent-transaction-id-of-the-following-capture-authorization",
        "completion-time-stamp" : "2018-09-26T05:54:20",
        "requested-amount" : {
            "currency" : "EUR",
            "value" : 10.100000
        },
        "statuses" : {
            "status" : [ {
                "description" : "The resource was successfully created.",
                "severity" : "information",
                "code" : "201.0000"
            } ]
        },
        "api-id" : "wpp",
        "success-redirect-url" : "https://demoshop-test.wirecard.com/demoshop/#!/success",
        "cancel-redirect-url" : "https://demoshop-test.wirecard.com/demoshop/#!/cancel",
        "fail-redirect-url" : "https://demoshop-test.wirecard.com/demoshop/#!/error"
    }
}
----

*Field (JSON)*

*Data Type*

*Description*

merchant-account-id

value

String

A unique identifier assigned to every merchant account (by Wirecard).
You receive a unique merchant account ID for each payment method.

request-id

String

A unique identifier assigned by the merchant to each request. Used when
searching for or referencing it later.

account-holder

merchant-crm-id

String

Unique ID identifying the consumer of your online shop, e.g. from your
CRM system. +
The parameter must not be a human readable e-mail address. However, if
an e-mail address is used, you have to hash it beforehand.

transaction-type

String

The requested transaction type, i.e. "`authorization"`.

parent-transaction-id

String

The ID of the transaction being referenced as a parent (e.g. the
transaction ID of a previous internal get-url).

payment-method

name

String

The name of the payment method used for the transaction, i.e.
"`paysafecard"`.

transaction-state

String

The current transaction state.

Possible values:

* `in-progress`
* `success`
* `failed`

Typically, a transaction starts with state `"in-progress"` and finishes
with state either `"success"` or `"failed"`. This information is
returned in the response only.

transaction-id

String

A unique identifier assigned to every transaction. Used when searching
for or referencing it later. +
The transaction ID of an authorization is the parent-transaction-id of
the following capture-authorization request.

completion-time-stamp

Date

The UTC/ISO time-stamp documenting the time & date when the transaction
was executed. +
Format: YYYY-MM-DDThh:mm:ss.sssZ (ISO).

requested-amount 

value

Numeric

The full amount that was requested/contested in the transaction.

currency

String

The currency of the requested/contested transaction amount. +
Format: 3-character abbreviation according to ISO 4217.

status +
 +

description

String

The description of the transaction status message. +
Click https://document-center.wirecard.com/display/PTD/Return+Codes+and+Transaction+Statuses[here] for
a complete list of status descriptions.

severity

String

The definition of the status message.

Possible values:

* `information`
* `warning`
* `error`

code

String

Status code of the status message. +
Click https://document-center.wirecard.com/display/PTD/Return+Codes+and+Transaction+Statuses[here] for
a complete list of status codes.

api-id

String

Identifier of the currently used API.

success-redirect-url

String

The URL to which the consumer is redirected after a successful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/success`

cancel-redirect-url

String

The URL to which the consumer is redirected after having cancelled a
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/cancel`

fail-redirect-url

String

The URL to which the consumer is redirected after an unsuccessful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/error`

'''''

[[paysafecardwithWPP-Capture-AuthorizationCapture-authorization]]
[[paysafecardwithWPP-Capture-Authorization]]Capture-authorization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A capture-authorization transfers funds reserved by a
prior link:#paysafecardwithWPP-Authorization[authorization] request from
the consumer's account. +
To refer to a preceding authorization, use the
field `parent-transaction-id`. The `transaction-id` from an
authorization response is the `parent-transaction-id` of the
following `capture-authorization` request.

API Endpoints

*Test*

`https://wpp-test.wirecard.com/api/payment/register`

*Production/Live*

Contact mailto:support@wirecard.com[merchant support] for your
production credentials.

*Request headers*

[source,syntaxhighlighter-pre]
----
Content-Type: application/json
Authorization: Basic NzAwMDAtQVBJVEVTVC1BUDpxRDJ3elFfaHJjITg=
----

 

*Capture-Authorization (request)*

[source,syntaxhighlighter-pre]
----
{
    "payment": {
        "merchant-account-id":{
            "value":"4c0de18e-4c20-40a7-a5d8-5178f0fe95bd"
        },
        "request-id":"{{$guid}}",
        "transaction-type":"capture-authorization",
        "parent-transaction-id": "enter-the-transaction-id-of-the-preceding-authorization",
        "requested-amount":{  
            "value":10.1,
            "currency":"EUR"
        },
        "payment-methods":{  
            "payment-method":[  
                {  
                   "name":"paysafecard"
                }
            ]
        },
        "account-holder":{
            "merchant-crm-id":"A123456789"
        },
        "notifications": {
            "notification": [
                {
                "url": "https://yourdomain.com/ipn.php"
                }
            ]
        },
        "success-redirect-url":"https://demoshop-test.wirecard.com/demoshop/#!/success",
        "cancel-redirect-url":"https://demoshop-test.wirecard.com/demoshop/#!/cancel",
        "fail-redirect-url":"https://demoshop-test.wirecard.com/demoshop/#!/error"
   }
}
----

*Field (JSON)*

*Data Type*

*Required/* +
*Optional*

*Size*

*Description*

merchant-account-id

value

String

required

36

A unique identifier assigned to every merchant account (by Wirecard).
You receive a unique merchant account ID for each payment method.

request-id

String

required

64

A unique identifier assigned by the merchant to each request. Used when
searching for or referencing it later.

You may enter any `request-id` that has never been used before.

As the request-id must be unique, `{{$guid}}` serves as a placeholder;
e.g. Postman uses it to generate a random` request-id` for testing. 

Allowed characters: +
a - z +
0 - 9 +
-

transaction-type

String

required

n/a

The requested transaction type, i.e. "`capture-authorization"`.

Available transaction types for paysafecard:

* `authorization`
* `capture-authorization`
* `debit`

parent-transaction-id

String

required

36

The transaction ID of the preceding authorization. +
You can only capture-authorize a transaction that has already been
authorized.

requested-amount

value

Numeric

required

9.2

The full amount that is requested/contested in a transaction. 2 decimal
digits allowed.

currency

String

required

3

The currency of the requested/contested transaction amount. +
Format: 3-character abbreviation according to ISO 4217.

payment-method

name

String

required

256

The name of the payment method used for the transaction, i.e.
`"paysafecard"`.

account-holder

merchant-crm-id

String

required

64

The unique identifier of your consumer of your online shop, e.g. from
your CRM system. +
The parameter must not be a human readable e-mail address. However, if
an e-mail address is used, you have to hash it beforehand.

notification-url

String

optional

256

The URL to which Wirecard Payment Gateway sends the transaction outcome.

success-redirect-url

String

required

2000

The URL to which the consumer is redirected after a successful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/success `

cancel-redirect-url

String

required

2000

The URL to which the consumer is redirected after having cancelled a
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/cancel `

fail-redirect-url

String

required

2000

The URL to which the consumer is redirected after an unsuccessful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/error  `

The response to this request contains the following information:

*Capture-authorization (response)*

[source,syntaxhighlighter-pre]
----
{
    "payment": {
        "merchant-account-id": {
            "value": "4c0de18e-4c20-40a7-a5d8-5178f0fe95bd"
        },
        "request-id": "37f26cbf-f4aa-429e-9966-82d2b3cbad46",
        "account-holder": {
            "merchant-crm-id": "A123456789"
        },
        "transaction-type": "capture-authorization",
        "parent-transaction-id": "6dadad3d-3cbd-4789-8165-ffdf15752bca",
        "payment-methods": {
            "payment-method": [
                {
                    "name": "paysafecard"
                }
            ]
        },
        "transaction-state": "success",
        "transaction-id": "2a1baa9d-d29f-408c-8bed-ec38194e4e16",
        "completion-time-stamp": "2018-10-01T13:17:58",
        "requested-amount": {
            "value": 10.1,
            "currency": "EUR"
        },
        "statuses": {
            "status": [
                {
                    "code": "201.0000",
                    "description": "paysafecard:The resource was successfully created.",
                    "severity": "information"
                }
            ]
        },
        "api-id": "wpp",
        "success-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/success",
        "cancel-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/cancel",
        "fail-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/error",
        }
    }
}
----

*Field (JSON)*

*Data Type*

*Description*

merchant-account-id

value

String

A unique identifier assigned to every merchant account (by Wirecard).
You receive a unique merchant account ID for each payment method.

request-id

String

A unique identifier assigned to every request (by merchant). Used when
searching for or referencing it later.

account-holder

merchant-crm-id

String

Unique ID identifying the consumer of your online shop, e.g. from your
CRM system. +
The parameter must not be a human readable e-mail address. However, if
an e-mail address is used, you have to hash it beforehand.

transaction-type

String

The requested transaction type, i.e. "`capture-authorization"`.

parent-transaction-id

String

The ID of the transaction being referenced as a parent, i.e. the
transaction ID of the preceding authorization.

payment-method

name

String

The name of the payment method used for the transaction, i.e.
"`paysafecard"`.

transaction-state

String

The current transaction state.

Possible values:

* `in-progress`
* `success`
* `failed`

Typically, a transaction starts with state `"in-progress"` and finishes
with state either `"success"` or `"failed"`. This information is
returned in the response only.

transaction-id

String

A unique identifier assigned to every transaction. Used when searching
for or referencing it later.

completion-time-stamp

Date

The UTC/ISO time-stamp documenting the time & date when the transaction
was executed. +
Format: YYYY-MM-DDThh:mm:ss.sssZ (ISO).

requested-amount 

value

Numeric

The full amount that was requested/contested in the transaction.

currency

String

The currency of the requested/contested transaction amount. +
Format: 3-character abbreviation according to ISO 4217.

status +
 +

description

String

The description of the transaction status message. +
Click https://document-center.wirecard.com/display/PTD/Return+Codes+and+Transaction+Statuses[here] for
a complete list of status descriptions.

severity

String

The definition of the status message.

Possible values:

* `information`
* `warning`
* `error`

code

String

Status code of the status message. +
Click https://document-center.wirecard.com/display/PTD/Return+Codes+and+Transaction+Statuses[here] for
a complete list of status codes.

api-id

String

Identifier of the currently used API.

success-redirect-url

String

The URL to which the consumer is redirected after a successful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/success`

cancel-redirect-url

String

The URL to which the consumer is redirected after having cancelled a
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/cancel`

fail-redirect-url

String

The URL to which the consumer is redirected after an unsuccessful
payment, +
e.g. `https://demoshop-test.wirecard.com/demoshop/#!/error`

'''''

[[paysafecardwithWPP-Void-authorization]]
Void-authorization
------------------

You may cancel an authorization using
the https://document-center.wirecard.com/display/PTD/REST+API[REST
API] if

* the authorization was successful and
* had not yet been captured and
* had not been voided before.

Only the whole authorized amount may be voided.

You must provide the necessary data:

* `parent-transaction-id`: This is the transaction ID of the preceding
authorization. You can gather it from the response to a successful
authorization.

'''''

[[paysafecardwithWPP-NVPFieldReference]]
NVP Field Reference
-------------------

NVP equivalents for JSON fields (for migrating merchants)

*JSON Structure for paysafecard Requests*

[source,syntaxhighlighter-pre]
----
{    "payment":{
        "merchant-account-id":{
            "value":"string"
        },
        "request-id":"string",
        "transaction-type":"string",
        "requested-amount":{
            "value":0,
            "currency":"string"
        },
        "account-holder":{
            "merchant-crm-id":"string"
        },
        "payment-methods":{
            "payment-method":[
               {
               "name":"paysafecard"
                }
            ]
        },
        "success-redirect-url": "string",
        "cancel-redirect-url": "string",
        "fail-redirect-url": "string"
    }
}
----

[cols=",,",]
|=================================================================
|*Field (NVP)* |*Field (JSON)* |*JSON Parent*
|merchant_account_id |value |merchant-account-id (\{ })
|request_id |request-id |payment (\{ })
|transaction_type |transaction-type |payment (\{ })
|requested_amount |value |requested-amount (\{ })
|requested_amount_currency |currency |requested-amount (\{ })
|merchant_crm_id |merchant-crm-id |account-holder (\{ })
|payment_method |payment-method ([ ])/name |payment-methods (\{ })
|success_redirect_url |success-redirect-url |payment (\{ })
|fail_redirect_url |fail-redirect-url |payment (\{ })
|cancel_redirect_url |cancel-redirect-url |payment (\{ })
|ip_address |ip-address |payment (\{ })
|=================================================================

[[paysafecardwithWPP-Response-onlyFields]]
Response-only Fields
~~~~~~~~~~~~~~~~~~~~

[source,syntaxhighlighter-pre]
----
{
    "payment" : {
        "transaction-state" : "string",
        "transaction-id" : "string",
        "completion-time-stamp" : "date",
        "api-id" : "string",
        "statuses" : {
            "status" : [ {
                "description" : "string",
                "severity" : "string",
                "code" : "string"
            } ]
        }
    }
}
----

[cols=",,",]
|====================================================================
|*Field (NVP)* |*Field (JSON)* |*JSON Parent*
|transaction_id |transaction-id |payment (\{ })
|transaction_state |transaction-state |payment (\{ })
|completion_time_stamp |completion-time-stamp |payment (\{ })
|api_id |api-id |payment (\{ })
|status_description_n |status ([ \{} ])/ description |statuses (\{ })
|status_severity_n |status ([ \{} ])/ severity |statuses (\{ })
|status_code_n |status ([ \{} ])/ code |statuses (\{ })
|====================================================================

Attachments:
~~~~~~~~~~~~

image:images/icons/bullet_blue.gif[image,width=8,height=8]
link:attachments/4390994/4391012.png[paysafecard.png] (image/png) +

[[footer]]
Document generated by Confluence on Feb 06, 2019 10:33

[[footer-logo]]
http://www.atlassian.com/[Atlassian]
