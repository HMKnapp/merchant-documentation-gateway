include::shortcuts.adoc[]
:payment-method-name: giropay

[#PPv2_giropay]
===== {payment-method-name}

_{payment-method-name}_ is a type of <<PaymentMethods_PaymentMode_OnlineBankTransfer, Online Bank Transfer>>

.Countries and Currencies

[cols="20h,80"]
|===
|Countries    
| Germany

|Currencies   
| EUR
|===

[#PPv2_giropay]
====== General Information

include::include/ppv2-general-information.adoc[]

Below, we provide a sample request/sample requests for the available transaction type/types <<PPv2_giropay_Samples_debitauth, insert relevant *{transaction-type}* and adapt type/types accordingly>>
, including field lists with short descriptions.

include::include/ppv2-general-information-2.adoc[]

[#PPv2_giropay_Transactions]
====== Transaction Type/ Types {transaction-type}

////
Choose the relevant description for the transaction :
With _{payment-method-name}_ you can use the transaction types <<link, *debit*>> and <<link, *authorization*>>.

A _debit_ charges the specified amount from the account holder’s bank account and marks it for immediate transfer.

An _authorization_ reserves the specified amount from the account holder’s bank account for a later transfer.
////


[#PPv2_giropay_TestCredentials]
====== Test Credentials

.Test Credentials for Transaction Type _debit_

[cols="20h,80"]
|===
|URL (Endpoint)
|``\https://{pp-test-endpoint}``

| Merchant Account ID (MAID)
a| 9b4b0e5f-1bc8-422e-be42-d0bad2eadabc

| Username
a| 16390-testing

| Password
a| 3!3013=D3fD8X7

| Secret Key (used for response verification)
a| 0c8c6f3a-1534-4fa1-99d9-d1c644d43709
|===

.Banking Credentials

[cols="20h,80"]
|===

| BIC
| GENODETT488
|===

[#PPv2_giropay_Samples]
====== Sample Workflow
====
*For a successful transaction:*

. Create a payment session (initial request).
. Redirect the consumer to the payment page (initial response URL).
. Highly recommended: Parse and process the payment response.

//-
====
We provide JSON examples for each step of this process. You can find them below.

.Request Headers
[cols="20h,80"]
|===
|Authorization
a| Use username and password as given in your {payment-provider-name} contract to _Base64_ encode the authorization.

For example for `user:password` the authorization header is:
[source]
----
Authorization: Basic dXNlcjpwYXNzd29yZA==
----
|Content-Type
a|
For _JSON_ requests the content type header is:
[source]
----
Content-Type: application/json;charset=UTF-8
----
|===


[#PPv2_giropay_TransactionType_debitauth_Create]
.1. Create a Payment Session (Initial Request)

You can use the following sample for either transaction type. Please enter the desired value (``debit`` or ``authorization``) for ``transaction-type``.

[source,json]
----
//insert sample here
----

////
Please adapt the following field table:
- Include only fields that are shown in the request.
- Order the fields by the sequence in which they appear in the request.
- Use only datatypes as indicated in the merging table. See: "templates > fields > datatypes.adoc".
- Check cardinality and size.
- Adapt description. Please give preference to PP v2 descriptions, if available.
Please expand the table as is needed. If possible, please add fields also to this template to make life easier for the other writers.
////

//It may be necessary to format the table a little bit differently, e.g. 4+|Field (JSON), etc.

[%autowidth, cols="m,,,,,,"]
|===
3+|Field (JSON) |Data Type |Cardinality |Size |Description

2+|merchant-account-id 
m|value 
|String 
| 
|36 
|A unique identifier assigned to every merchant account (by {payment-provider-name}).

3+|request-id 
|String 
|
|64 
|A unique identifier assigned to every request (by merchant). Used when searching for or referencing it later. ``{{$guid}}`` serves as a placeholder for a random request-id. +
Allowed characters: `[a-z0-9-_ ]`

3+|transaction-type 
|String 
|  
|36
a|The requested transaction type. Available transaction types for _{payment-method-name}_:

- `debit`
- `authorization`

//-

.2+|requested-amount  
2+m|value 
|Numeric 
| 
|18
|The full amount that is requested/contested in a transaction. 2 decimal places allowed. +
Use `.` (decimal point) as the separator. 

2+|currency 
|String 
| 
|3 
|The currency of the requested/contested transaction amount. For _{payment-method-name}_ payments, the currency must be set to ``EUR``.
Format: 3-character abbreviation according to ISO 4217.

|payment-methods 
m|payment-method 
m|name 
|String 
|
|256 
|The name of the payment method used. Set this value to 
//``INSERT payment-method``.

.3+|bank-account 
2+m|bic
|String 
| 
|32 ?????
|The bank identifier code (BIC) in bank transfer. +
Allowed characters: ([a-zA-Z]{4}[a-zA-Z]{2}[a-zA-Z0-9]{2}([a-zA-Z0-9]{3}). +
If provided, redirect to giropay sandbox will be initiated. If not provided, WPP v2 shows sandbox where to enter BIC

3+|success-redirect-url 
|String 
|Required 
|2000 
|The URL to which the consumer is redirected after a successful payment, e.g. ``\https://{pp-redirect-url-success}``

3+|cancel-redirect-url 
|String 
|Required 
|2000 
|The URL to which the consumer is redirected after having canceled a payment, e.g. ``\https://{pp-redirect-url-cancel}``

3+|fail-redirect-url 
|String 
|Required 
|2000 
|The URL to which the consumer is redirected after an unsuccessful payment, e.g. ``\https://{pp-redirect-url-error}``
|===

[#PPv2_complete anchor]
.2. Redirect the Consumer to the Payment Page (Sample Response URL)

[source,json]
----
insert redirect-url here
----

[%autowidth, cols="m,,"]
|===
| Field (JSON) | Data Type | Description

|payment-redirect-url 
|String 
|The URL which redirects to the payment
form. Sent as a response to the initial request.
|===

include::include/ppv2-redirect-instructions.adoc[]

[#PPv2_complete anchor]
.3. Parse and Process the Payment Response (Decoded Payment Response)

[source,json]
----
//insert decoded payment response here
----

////
Please adapt the following field table:
- Include only fields that are shown in the payment response.
- Order the fields by the sequence in which they appear in the payment response.
- Use only datatypes as indicated in the merging table. See: "templates > fields > datatypes.adoc".
- Adapt description (give PPv2 descriptions preference).
- Please expand the table as is needed. If possible, please add fields also to this template to make life easier for the other writers.
- If you rephrase descriptions for fields (part of this template or not), please notify Karin Kraus.

NOTE: It's not necessary to include Cardinality and Size in the response table.
////

[%autowidth, cols=",,,"]
|===
2+| Field (JSON) | Data Type | Description

2+|transaction-id 
|String 
|A unique identifier assigned for every transaction. This information is returned in the response only.

2+|request-id 
|String 
|A unique identifier assigned to every request (by merchant). Used when searching for or referencing it later.

2+|transaction-type 
|String 
|The requested transaction type. For _{payment-method-name}_ payments, the
transaction-type is ``{transaction-type}``.

2+|transaction-state 
|String 
a|The current transaction state. +
Possible values:

- ``in-progress``
- ``success``
- ``failed``

//-

Typically, a transaction starts with state ``in-progress`` and finishes with state either ``success`` or ``failed``. This information is returned in the response only.

2+|completion-time-stamp 
|YYYY-MM-DD-Thh:mm:ss 
|The UTC/ISO time-stamp documents the time and date when the transaction was executed. +
Format: YYYY-MM-DDThh:mm:ss (ISO).

.2+|requested-amount 
|currency 
|String 
|The currency of the requested/contested transaction amount. For {payment-method-name} payments, the currency must be set to ``{currency}``. +
Format: 3-character abbreviation according to ISO 4217.
                      
|value    
|Numeric 
|The full amount that is requested/contested in a transaction.

.3+|status 
|description 
|String 
|The description of the transaction status message.

|severity    
|String 
a|The definition of the status message. Possible values:

- ``information``
- ``warning``
- ``error``

//-

|code 
|String 
|Status code of the status message.

2+|authorization-code 
|String 
|Output code for transaction type ``authorization``.

2+|parent-transaction-id 
|String 
|The ID of the transaction referenced as a parent.

.2+|card-token 
|token-id 
|String 
|A unique identifier assigned to every card token.

|masked-account-number  
|String 
|This is the masked card account number of the consumer.

2+|success-redirect-url 
|String 
|The URL to which the consumer is redirected after a successful payment, e.g. ``\https://{pp-redirect-url-success}``.

2+|processing-redirect-url 
|String 
|The URL to which the consumer is redirected after completing the payment. This is normally a page on the merchant’s website.

|merchant-account-id  
|value  
|String 
|A unique identifier assigned to every merchant account (by {payment-provider-name}).

2+|cancel-redirect-url 
|String 
|The URL to which the consumer is redirected after having canceled a payment, e.g. ``\https://{pp-redirect-url-cancel}``.

2+|fail-redirect-url 
|String 
|The URL to which the consumer is redirected after a failed payment, e.g. ``\https://{pp-redirect-url-error}``.

.3+|account-holder 
|first-name 
|String 
|The first name of the consumer.

|last-name  
|String 
|The last name of the consumer.

|email  
|String 
|The email address of the consumer.

.2+|payment-method 
|payload  
|String  
a|Only if `transaction-state` is `success`. 
//Description may depend on payment method.

|name 
|String 
|The name of the payment method used.

2+|api-id       
|String 
|Identifier of the currently used API.

2+|descriptor   
|String    
|Description of the transaction for account holder's bank statement purposes.
|===

[#PPv2_giropay_PostProcessing]
====== Post-Processing Operations 

include::include/ppv2-post-processing-operation.adoc[]

//CAUTION: For these sections, the title is still part of the include file. Since these have been used for several payment methods, we will not include the title in the payment-method file for now.
//PLEASE INSERT ANCHORS FOR THESE SECTIONS HERE!

[#PPv2_giropay_JSONFields]
include::include/ppv2-apm-optional-fields.adoc[]

[#PPv2_giropay_JSONNVPReference]
include::include/ppv2-apm-json-nvp-reference.adoc[]

//If you have any questions or suggestions, please contact Karin Kraus.

//-
