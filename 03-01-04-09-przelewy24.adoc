[[page]]
[[main]]
[[main-header]]
[[breadcrumb-section]]
1.  link:index.html[API merchant specification]
2.  link:API-merchant-specification_1146901.html[API merchant
specification]
3.  link:Payment-Page-Solutions_4751423.html[Payment Page Solutions]
4.  link:Wirecard-Payment-Page_3704201.html[Wirecard Payment Page]
5.  link:Payment-Methods-with-WPP_3704241.html[Payment Methods with WPP]

[[title-heading]]
[[title-text]] API merchant specification : Przelewy24 with WPP
----------------------------------------------------------------

[[content]]
Created by Karin Kraus, last modified on Oct 31, 2018

[[main-content]]
* link:#Przelewy24withWPP-TestCredentials[Test Credentials]
* link:#Przelewy24withWPP-TransactionTypes[Transaction Types]
** link:#Przelewy24withWPP-DebitDebit[Debit]
* link:#Przelewy24withWPP-Refund[Refund]
* link:#Przelewy24withWPP-NVPFieldReference[NVP Field Reference]
** link:#Przelewy24withWPP-Response-onlyFields[Response-only Fields]

 

This is a reference page for *Przelewy24 (P24)*. Here you find all the
information necessary for integrating this payment method in
your https://document-center.wirecard.com/display/PTD/Hosted+Payment+Page[Hosted] and https://document-center.wirecard.com/display/PTD/Embedded+Payment+Page[Embedded] Payment
Page.

Are you unfamiliar with Wirecard Payment Page (WPP)?

Visit one of the integration guides
(**https://document-center.wirecard.com/display/PTD/Hosted+Payment+Page[Hosted] **or **https://document-center.wirecard.com/display/PTD/Embedded+Payment+Page[Embedded] **Payment
Page) for a quick explanation & a step-by-step guide before
continuing. +
All **https://document-center.wirecard.com/display/PTD/Wirecard+Payment+Page[WPP]** integrations
share
a *https://document-center.wirecard.com/display/PTD/WPP+Workflow[common
process flow]* for creating payments.

Below, you find example requests for the transaction
type link:#Przelewy24withWPP-Debit[Debit], including field lists with
short descriptions.

These requests are *designed for the testing environment* and *do not
use real information*.  +
For your production environment, you need to use your production
credentials.

All examples presented here should return successful responses.

For more details on the `redirect-url`s, see
the https://confluence.wirecard.sys/display/PTD/Configuring+Redirects+and+IPNs+for+WPP[Configuring
Redirects and IPNs for WPP] section. +
For response verification examples, see
the https://confluence.wirecard.sys/display/PTD/WPP+Security[WPP
Security] section.

*About Przelewy24*

 

image:attachments/4391015/4391019.png[image,width=200]

Przelewy24 (P24) offers bank transfers and other payment methods for the
Polish e-commerce sector. 80-90% of online payments in Poland happen via
bank transfer, making P24 the most popular payment service in this
region.

Currently, Przelewy24 cooperates with 165 banks.

Consumers select the bank of their choice. P24 redirects them to that
bank's login page. There, consumers use their bank credentials to log
in, and then initialise the transaction. Upon payment confirmation,
merchants and consumers receive a notification of the transaction
outcome.

 

 

'''''

 

[[Przelewy24withWPP-TestCredentials]]
Test Credentials
----------------

Merchant Credentials

*URI (Endpoint)*

https://wpp-test.wirecard.com/api/payment/register

*Username*

....
16390-testing
....

*Password*

....
3!3013=D3fD8X7
....

*MAID (`merchant-account-id`)*

....
86451785-3ed0-4aa1-99b2-cc32cf54ce9a
....

*Secret Key (used for response verification)*

....
fdd54ea1-cef1-449a-945c-55abc631cfdc
....

P24 Sandbox Credentials

Our test environment is connected to the P24 sandbox which does not
require you to enter any additional data. The P24 landing page will ask
you to select a bank. You will be redirected to a page that asks for
payment confirmation. Upon confimation of your test payment, P24
immediately returns you to your shop.

image:attachments/4391015/4391020.png[image,width=570]

 

'''''

[[Przelewy24withWPP-TransactionTypes]]
Transaction Types
-----------------

One transaction type is available for *Przelewy24*:

[[Przelewy24withWPP-DebitDebit]]
[[Przelewy24withWPP-Debit]]Debit
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A debit transaction charges the account holder's bank account with
the specified amount and transfers it immediately.

For a successful debit transaction:

1.  Create a payment session (initial request).
2.  Redirect the consumer to the payment page (initial response URL).
3.  Highly recommended: Parse and process the payment response.

We provide ready-made JSON examples for every step of this process. You
find them below.

API Endpoints

*Test*

https://wpp-test.wirecard.com/api/payment/register

*Production/Live*

https://wpp.wirecard.com/api/payment/register[C]ontact mailto:support@wirecard.com[merchant
support] for your production credentials.

The examples show an initial request which creates the payment session.
If it is successful, you receive a URL as a response, which redirects to
the payment form.

*Request Header*

[source,syntaxhighlighter-pre]
----
Authorization: Basic MTYzOTAtdGVzdGluZzozITMwMTM9RDNmRDhYNw==
Content-Type: application/json
----

 

{empty}[[Przelewy24withWPP-SampleRequest]]

 

*1. Create a Payment Session (Initial Request)*

[source,syntaxhighlighter-pre]
----
{
    "payment": {
        "merchant-account-id": {
            "value": "86451785-3ed0-4aa1-99b2-cc32cf54ce9a"
        },
        "request-id": "{{$guid}}",
        "order-number": "123456789"
        "transaction-type": "debit",
        "requested-amount": {
            "value": "10.00",
            "currency": "PLN"
        },
        "account-holder": {
            "first-name": "Paul",
            "last-name": "Atreides",
            "email": "paul.atreides@example.com"
        },
        "payment-methods": {
            "payment-method": [
                {
                "name": "p24"
                }
            ]
        },
        "country": "PL",
        "locale": "en" 
        "notifications": {
            "notification": [
                {
                "url": "https://example.com/"
                }
            ]
        },
        "descriptor": "test",
        "success-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/success",
        "cancel-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/cancel",
        "fail-redirect-url": "https://demoshop-test.wirecard.com/demoshop/#!/error"
    }
}
----

*Field (JSON)*

*Data Type*

*Required/Optional*

*Size*

*Description*

merchant-account-id

value

String

required

36

A unique identifier assigned to every merchant account (by Wirecard).

request-id

String

required

64

A unique identifier assigned to every request (by merchant). Used when
searching for or referencing it later. `{{$guid}}` serves as a
placeholder for a random request-id.

order-number

String

required

64

This is the order number of the merchant. If provided, it is displayed
on the P24 landing page as “Order Information”

transaction-type

String

required

30

The requested transaction type. For P24 payments, the transaction-type
must be set to `debit`.

requested-amount 

value

Numeric

required

18

The full amount that is requested/contested in a transaction. 2 decimal
places allowed.

currency

String

required

3

The currency of the requested/contested transaction amount. For P24
payments, the currency must be set to `PLN`.

account-holder

first-name

String

optional

32

The first name of the account holder.

last-name

String

required

32

The last name of the account holder.

email

String

required

64

The email-address of the account holder.

payment-method

name

String

required

15

The name of the payment method used. Set this value to `p24`.

country

String

optional

3

The country ID of the account holder. It must be `PL`; if it is not
provided, it will be automatically set to `PL`.

locale

String

optional

6

With this field you can specify language in which P24 landing page is
displayed.

Possible values:

* `pl`
* `en`
* `de`
* `es`
* `it`

notification-url

String

optional

256

The URL with which the merchant is notified about the transaction
outcome.

descriptor

String

optional

64

Describes the transaction. It is shown on the account holder's statement
along with the P24-Transaction-ID. See
section https://confluence.wirecard.sys/display/PTD/Przelewy24#Przelewy24-BankingStatement[Banking
Statement] for details on the P24-Transaction-ID.

Length and allowed characters depend on the respective consumer's bank
system and can vary.

success-redirect-url

String

optional

256

The URL to which the consumer is redirected after successful payment, +
e.g. https://demoshop-test.wirecard.com/demoshop/#!/success

fail-redirect-url

String

optional

256

The URL to which the consumer is redirected after unsuccessful
payment, +
e.g. https://demoshop-test.wirecard.com/demoshop/#!/error

cancel-redirect-url

String

optional

256

The URL to which the consumer is redirected after having cancelled
payment, +
e.g. https://demoshop-test.wirecard.com/demoshop/#!/cancel

*2. Redirect the Consumer to the Payment Page (Initial Response)*

[source,syntaxhighlighter-pre]
----
{
    "payment-redirect-url": "https://wpp-test.wirecard.com/processing?wPaymentToken=x_APEDQWk8g55wmeAyagobjTt5_p-pyHof8w6zJiTGI"
}
----

[cols=",,",]
|=======================================================================
|*Field (JSON)* |*Data Type* |*Description*

|payment-redirect-url |String |The URL which redirects to the payment
form. Sent as a response to the initial request.
|=======================================================================

At this point, you need to redirect your consumer
to `payment-redirect-url` (or render it in an `iframe` depending on
your https://confluence.wirecard.sys/display/PTD/Wirecard+Payment+Page[integration
method]).

The costumers are redirected to the payment form. There they enter their
data and submit the form to confirm the payment. A payment can

* be successful (`transaction-state: success`),
* fail (`transaction-state: failed`),
* or the consumer cancels the payment before/after
submission (`transaction-state: failed`).

The transaction result is the value of `transaction-state `in the
payment response. More details (including the status code) can also be
found in the payment response in the `statuses` object. Canceled
payments are returned as `"transaction-state" : "failed"`, but the
status description indicates it has been cancelled.

In any case (unless the consumer cancels the transaction on a 3rd party
provider page), a base64 encoded response containing payment information
is sent to the configured redirection
URL. See https://document-center.wirecard.com/display/PTD/Configuring+Redirects+and+IPNs+for+WPP[Configuring
Redirects and IPNs for WPP] for more details on redirection targets
after payment & transaction status notifications.

You can find a decoded payment response example below.

*3. Parse and Process the Payment Response (Decoded Payment Response)*

[source,syntaxhighlighter-pre]
----
{
    "payment" : {
        "notifications" : {
        "notification" : [ 
            {
            "url" : "https://example.com/"
            } 
        ]
    },
    "locale" : "en",
    "parent-transaction-id" : "dc189b09-3cd9-4984-9df3-0984b5218b6c",
    "statuses" : {
        "status" : [ 
            {
            "description" : "The resource was successfully created.",
            "severity" : "information",
            "code" : "201.0000"
            } 
        ]
    },
    "cancel-redirect-url" : "https://demoshop-test.wirecard.com/demoshop/#!/cancel",
    "success-redirect-url" : "https://demoshop-test.wirecard.com/demoshop/#!/success",
    "fail-redirect-url" : "https://demoshop-test.wirecard.com/demoshop/#!/error",
    "account-holder" : {
        "first-name" : "Paul",
        "last-name" : "Atreides",
        "email" : "paul.atreides@example.com"
    },
    "request-id" : "85ac92ca-2f18-4af0-961c-1995cf494002",
    "transaction-id" : "2cd6a138-5dde-4efc-b196-7a75d930a1e2",
    "completion-time-stamp" : "2018-10-15T08:13:37",
    "requested-amount" : {
        "currency" : "PLN",
        "value" : 10.000000
    },
    "merchant-account-id" : {
        "value" : "86451785-3ed0-4aa1-99b2-cc32cf54ce9a"
    },
    "transaction-state" : "success",
    "transaction-type" : "debit",
    "payment-methods" : {
        "payment-method" : [ 
            {
            "name" : "p24"
            } 
        ]
    },
    "order-number" : "123456789",
    "api-id" : "wpp",
    "descriptor" : "test",
    "country" : "PL"
    }
}
----

*Field (JSON)*

*Data Type*

*Description*

notification url

String

The URL with which the merchant is notified about the transaction
outcome.

locale

String

With this field you can specify language in which P24 landing page is
displayed.

Possible values:

* `pl`
* `en`
* `de`
* `es`
* `it`

parent-transaction-id

String

The ID of the transaction being referenced as parent. As
a `debit`transaction is internally split into sub-transactions,
the `parent-transaction-id` serves to link these sub-transactions.

status +
 +
  

description

String

The description of the transaction status message.

severity

String

The definition of the status message.

Possible values:

* `information`
* `warning`
* `error`

code

String

Status code of the status message.

cancel-redirect-url

String

The URL to which the consumer is redirected after having cancelled a
payment, +
e.g. https://demoshop-test.wirecard.com/demoshop/#!/cancel

success-redirect-url

String

The URL to which the consumer is redirected after a successful payment,
e.g. https://demoshop-test.wirecard.com/demoshop/#!/success

fail-redirect-url

String

The URL to which the consumer is redirected after a failed payment,
e.g. https://demoshop-test.wirecard.com/demoshop/#!/error 

account-holder

first-name

String

The first name of the account holder.

last-name

String

The last name of the account holder.

email

String

The email address of the account holder.

request-id

String

A unique identifier assigned to every request (by merchant). Used when
searching for or referencing it later.

transaction-id

String

A unique identifier assigned to every transaction. Used when searching
for or referencing it later.

completion-time-stamp

YYYY-MM-DDThh:mm:ss

The UTC/ISO time-stamp documents the time & date when the transaction
was executed. +
Format: YYYY-MM-DDThh:mm:ss (ISO).

requested-amount

currency

String

The currency of the requested/contested transaction amount.

value

Numeric

The full amount that is requested/contested in a transaction.

merchant-account-id

value

String

A unique identifier assigned to every merchant account (by Wirecard).
You receive a unique merchant account ID for each payment method.

transaction-state

String

The current transaction state.

Possible values:

* `in-progress`
* `success`
* `failed`

Typically, a transaction starts with state "`in-progress`" and finishes
with state either "`success`" or "`failed`". This information is
returned in the response only.

transaction-type

String

The requested transaction type. Must be `debit` for P24 payments.

payment method

name

String

The name of the payment method used.

order-number

String

This is the order number of the merchant. If provided, it is displayed
on P24 landing page as “Order Information”

api-id

String

Identifier of the currently used API.

descriptor

String

Describes the transaction. It is shown on the account holder's statement
along with the P24-Transaction-ID. See
section https://confluence.wirecard.sys/display/PTD/Przelewy24#Przelewy24-BankingStatement[Banking
Statement] for details on the P24-Transaction-ID.

Length and allowed characters depend on the respective consumer's bank
system and can vary.

country

String

The country ID of the account holder. It must be `PL`; if it is not
provided, it will be automatically set to `PL`.

'''''

 

[[Przelewy24withWPP-Refund]]
Refund
------

Basically, P24 with WPP supports debit only. You can integrate
a *https://document-center.wirecard.com/display/PTD/Przelewy24#Przelewy24-refundProcessUsingtheReSTAPI[refund
process for P24 via our REST API]*.

You must provide the necessary data:

* `parent-transaction-id`: This is the transaction ID of the preceding
debit. You can gather it from the response to a successful debit.
* `amount` (this can be either the total amount for refunding the full
amount, or a partial amount for a partial refund)

'''''

[[Przelewy24withWPP-NVPFieldReference]]
NVP Field Reference
-------------------

NVP equivalents for JSON fields (for migrating merchants)

*JSON Structure for P24 Requests*

[source,syntaxhighlighter-pre]
----
{
    "payment": {
        "merchant-account-id": {
            "value": "string"
        },
        "request-id": "string",
        "order-number": "string"
        "transaction-type": "string",
        "requested-amount": {
            "value": "0",
            "currency": "string"
        },
        "account-holder": {
            "first-name": "string",
            "last-name": "string",
            "email": "string"
        },
        "payment-methods": {
            "payment-method": [
                {
                "name": "string"
                }
            ]
        },
        "country": "string",
        "locale": "string" 
        "notifications": {
            "notification": [
                {
                "url": "string"
                }
            ]
        },
        "descriptor": "string",
        "success-redirect-url": "string",
        "cancel-redirect-url": "string",
        "fail-redirect-url": "string"
    }
}
----

[width="100%",cols="34%,33%,33%",]
|=================================================================
|*Field (NVP)* |*Field (JSON)* |*JSON Parent*
|merchant_account_id |value |merchant-account-id (\{ })
|request_id |request-id |payment (\{ })
|order_number |order-number |payment (\{ })
|transaction_type |transaction-type |payment (\{ })
|requested_amount |value |requested-amount (\{ })
|requested_amount_currency |currency |requested-amount (\{ })
|first_name |first-name |account-holder (\{ })
|last_name |last-name |account-holder (\{ })
|email |email |account-holder (\{ })
|payment_method |payment-method ([ ])/name |payment-methods (\{ })
|country |country |payment (\{ })
|locale |locale |payment (\{ })
|notification-url |url |notifications (\{ })
|descriptor |descriptor |payment (\{ })
|success_redirect_url |success-redirect-url |payment (\{ })
|fail_redirect_url |fail-redirect-url |payment (\{ })
|cancel_redirect_url |cancel-redirect-url |payment (\{ })
|=================================================================

'''''

[[Przelewy24withWPP-Response-onlyFields]]
Response-only Fields
~~~~~~~~~~~~~~~~~~~~

*P24 Response-only Fields*

[source,syntaxhighlighter-pre]
----
{
    "payment" : {
    "parent-transaction-id" : "string",
    "statuses" : {
        "status" : [ 
            {
            "description" : "string",
            "severity" : "string",
            "code" : "string"
            } 
        ]
    },
    "transaction-id" : "2cd6a138-5dde-4efc-b196-7a75d930a1e2",
    "completion-time-stamp" : "2018-10-15T08:13:37"
    },
    "transaction-state" : "string",
    "api-id" : "wpp"
    }
}
----

[cols=",,",]
|=================================================================
|*Field (NVP)* |*Field (JSON)* |*JSON Parent*
|parent_transaction_id |parent-transaction-id |payment (\{ })
|status_description_n |status ([ \{} ])/ severity |statuses (\{ })
|status_severity_n |status ([ \{} ])/ code |statuses (\{ })
|status_code_n |status ([ \{} ])/ description |statuses (\{ })
|transaction_id |transaction-id |payment (\{ })
|completion_time_stamp |completion-time-stamp |payment (\{ })
|transaction_state |transaction-state |payment (\{ })
|api_id |api-id |payment (\{ })
|=================================================================

Attachments:
~~~~~~~~~~~~

image:images/icons/bullet_blue.gif[image,width=8,height=8]
link:attachments/4391015/4391017.png[preview-przelewy.png] (image/png) +
image:images/icons/bullet_blue.gif[image,width=8,height=8]
link:attachments/4391015/4391019.png[Przelewy24.png] (image/png) +
image:images/icons/bullet_blue.gif[image,width=8,height=8]
link:attachments/4391015/4391020.png[P24_Demoshop.PNG] (image/png) +

[[footer]]
Document generated by Confluence on Feb 06, 2019 10:33

[[footer-logo]]
http://www.atlassian.com/[Atlassian]
